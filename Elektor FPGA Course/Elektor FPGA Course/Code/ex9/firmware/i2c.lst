                              1 ;--------------------------------------------------------
                              2 ; File Created by SDCC : FreeWare ANSI-C Compiler
                              3 ; Version 2.5.0 #1020 (May  8 2005)
                              4 ; This file generated Mon May 08 16:15:30 2006
                              5 ;--------------------------------------------------------
                              6 	.module i2c
                              7 	.optsdcc -mmcs51 --model-large
                              8 	
                              9 ;--------------------------------------------------------
                             10 ; Public variables in this module
                             11 ;--------------------------------------------------------
                             12 	.globl _I2C_get
                             13 	.globl _I2C_send
                             14 	.globl _I2C_delay
                             15 	.globl _I2C_init
                             16 	.globl _P0
                             17 	.globl _prev_P0
                             18 	.globl _I2C_start
                             19 	.globl _I2C_stop
                             20 ;--------------------------------------------------------
                             21 ; special function registers
                             22 ;--------------------------------------------------------
                             23 	.area RSEG    (DATA)
                    0080     24 _P0	=	0x0080
                             25 ;--------------------------------------------------------
                             26 ; special function bits 
                             27 ;--------------------------------------------------------
                             28 	.area RSEG    (DATA)
                             29 ;--------------------------------------------------------
                             30 ; overlayable register banks 
                             31 ;--------------------------------------------------------
                             32 	.area REG_BANK_0	(REL,OVR,DATA)
   0000                      33 	.ds 8
                             34 ;--------------------------------------------------------
                             35 ; internal ram data
                             36 ;--------------------------------------------------------
                             37 	.area DSEG    (DATA)
                             38 ;--------------------------------------------------------
                             39 ; overlayable items in internal ram 
                             40 ;--------------------------------------------------------
                             41 	.area OSEG    (OVR,DATA)
                             42 ;--------------------------------------------------------
                             43 ; indirectly addressable internal ram data
                             44 ;--------------------------------------------------------
                             45 	.area ISEG    (DATA)
                             46 ;--------------------------------------------------------
                             47 ; bit data
                             48 ;--------------------------------------------------------
                             49 	.area BSEG    (BIT)
                             50 ;--------------------------------------------------------
                             51 ; paged external ram data
                             52 ;--------------------------------------------------------
                             53 	.area PSEG    (PAG,XDATA)
                             54 ;--------------------------------------------------------
                             55 ; external ram data
                             56 ;--------------------------------------------------------
                             57 	.area XSEG    (XDATA)
   0000                      58 _prev_P0::
   0000                      59 	.ds 1
   0001                      60 _I2C_send_dat_1_1::
   0001                      61 	.ds 1
   0002                      62 _I2C_send_ack_1_1::
   0002                      63 	.ds 1
   0003                      64 _I2C_get_ack_1_1::
   0003                      65 	.ds 1
   0004                      66 _I2C_get_dat_1_1::
   0004                      67 	.ds 1
                             68 ;--------------------------------------------------------
                             69 ; external initialized ram data
                             70 ;--------------------------------------------------------
                             71 	.area XISEG   (XDATA)
                             72 	.area CSEG    (CODE)
                             73 	.area GSINIT0 (CODE)
                             74 	.area GSINIT1 (CODE)
                             75 	.area GSINIT2 (CODE)
                             76 	.area GSINIT3 (CODE)
                             77 	.area GSINIT4 (CODE)
                             78 	.area GSINIT5 (CODE)
                             79 ;--------------------------------------------------------
                             80 ; global & static initialisations
                             81 ;--------------------------------------------------------
                             82 	.area CSEG    (CODE)
                             83 	.area GSINIT  (CODE)
                             84 	.area GSFINAL (CODE)
                             85 	.area GSINIT  (CODE)
                             86 ;--------------------------------------------------------
                             87 ; Home
                             88 ;--------------------------------------------------------
                             89 	.area HOME    (CODE)
                             90 	.area CSEG    (CODE)
                             91 ;--------------------------------------------------------
                             92 ; code
                             93 ;--------------------------------------------------------
                             94 	.area CSEG    (CODE)
                             95 ;------------------------------------------------------------
                             96 ;Allocation info for local variables in function 'I2C_init'
                             97 ;------------------------------------------------------------
                             98 ;------------------------------------------------------------
                             99 ;i2c.c:20: void I2C_init (void)
                            100 ;	-----------------------------------------
                            101 ;	 function I2C_init
                            102 ;	-----------------------------------------
   0000                     103 _I2C_init:
                    0002    104 	ar2 = 0x02
                    0003    105 	ar3 = 0x03
                    0004    106 	ar4 = 0x04
                    0005    107 	ar5 = 0x05
                    0006    108 	ar6 = 0x06
                    0007    109 	ar7 = 0x07
                    0000    110 	ar0 = 0x00
                    0001    111 	ar1 = 0x01
                            112 ;i2c.c:22: prev_P0=0xff;			// set the port P0 to a know state
                            113 ;     genAssign
   0000 90s00r00            114 	mov	dptr,#_prev_P0
   0003 74 FF               115 	mov	a,#0xFF
   0005 F0                  116 	movx	@dptr,a
                            117 ;i2c.c:23: P0=prev_P0;
                            118 ;     genAssign
   0006 75 80 FF            119 	mov	_P0,#0xFF
                            120 ;i2c.c:24: I2C_start();			// reset the I2C-bus.
                            121 ;     genCall
   0009 12s00r1D            122 	lcall	_I2C_start
                            123 ;i2c.c:25: I2C_stop();
                            124 ;     genCall
                            125 ;	Peephole 253.b	replaced lcall/ret with ljmp
   000C 02s00r68            126 	ljmp	_I2C_stop
                            127 ;------------------------------------------------------------
                            128 ;Allocation info for local variables in function 'I2C_delay'
                            129 ;------------------------------------------------------------
                            130 ;x                         Allocated with name '_I2C_delay_x_1_1'
                            131 ;------------------------------------------------------------
                            132 ;i2c.c:28: void I2C_delay(void)
                            133 ;	-----------------------------------------
                            134 ;	 function I2C_delay
                            135 ;	-----------------------------------------
   000F                     136 _I2C_delay:
                            137 ;i2c.c:31: for (x=0;x<50;x++){};
                            138 ;     genAssign
   000F 7A 32               139 	mov	r2,#0x32
   0011 7B 00               140 	mov	r3,#0x00
   0013                     141 00103$:
                            142 ;     genDjnz
                            143 ;     genMinus
                            144 ;     genMinusDec
   0013 1A                  145 	dec	r2
   0014 BA FF 01            146 	cjne	r2,#0xff,00108$
   0017 1B                  147 	dec	r3
   0018                     148 00108$:
                            149 ;     genIfx
   0018 EA                  150 	mov	a,r2
   0019 4B                  151 	orl	a,r3
                            152 ;     genIfxJump
                            153 ;	Peephole 109	removed ljmp by inverse jump logic
   001A 70 F7               154 	jnz	00103$
   001C                     155 00109$:
   001C                     156 00104$:
   001C 22                  157 	ret
                            158 ;------------------------------------------------------------
                            159 ;Allocation info for local variables in function 'I2C_start'
                            160 ;------------------------------------------------------------
                            161 ;------------------------------------------------------------
                            162 ;i2c.c:34: void I2C_start(void)
                            163 ;	-----------------------------------------
                            164 ;	 function I2C_start
                            165 ;	-----------------------------------------
   001D                     166 _I2C_start:
                            167 ;i2c.c:36: SDA_HIGH		
                            168 ;     genAssign
                            169 ;     genOr
                            170 ;	Peephole 248.a	optimized or to xdata
   001D 90s00r00            171 	mov	dptr,#_prev_P0
   0020 E0                  172 	movx	a,@dptr
   0021 FA                  173 	mov	r2,a
   0022 44 01               174 	orl	a,#0x01
   0024 F0                  175 	movx	@dptr,a
                            176 ;     genAssign
   0025 90s00r00            177 	mov	dptr,#_prev_P0
   0028 E0                  178 	movx	a,@dptr
   0029 F5 80               179 	mov	_P0,a
                            180 ;     genCall
   002B 12s00r0F            181 	lcall	_I2C_delay
                            182 ;i2c.c:37: SCL_HIGH
                            183 ;     genAssign
                            184 ;     genOr
                            185 ;	Peephole 248.a	optimized or to xdata
   002E 90s00r00            186 	mov	dptr,#_prev_P0
   0031 E0                  187 	movx	a,@dptr
   0032 FA                  188 	mov	r2,a
   0033 44 02               189 	orl	a,#0x02
   0035 F0                  190 	movx	@dptr,a
                            191 ;     genAssign
   0036 90s00r00            192 	mov	dptr,#_prev_P0
   0039 E0                  193 	movx	a,@dptr
   003A F5 80               194 	mov	_P0,a
   003C                     195 00101$:
                            196 ;     genAnd
   003C 74 80               197 	mov	a,#0x80
   003E 55 80               198 	anl	a,_P0
                            199 ;     genCmpEq
                            200 ;	Peephole 112.b	changed ljmp to sjmp
                            201 ;	Peephole 115.b	jump optimization
   0040 FA                  202 	mov	r2,a
   0041 60 F9               203 	jz	00101$
   0043                     204 00108$:
                            205 ;     genCall
   0043 12s00r0F            206 	lcall	_I2C_delay
                            207 ;i2c.c:38: SDA_LOW
                            208 ;     genAssign
                            209 ;     genAnd
                            210 ;	Peephole 248.b	optimized and to xdata
   0046 90s00r00            211 	mov	dptr,#_prev_P0
   0049 E0                  212 	movx	a,@dptr
   004A FA                  213 	mov	r2,a
   004B 54 FE               214 	anl	a,#0xFE
   004D F0                  215 	movx	@dptr,a
                            216 ;     genAssign
   004E 90s00r00            217 	mov	dptr,#_prev_P0
   0051 E0                  218 	movx	a,@dptr
   0052 F5 80               219 	mov	_P0,a
                            220 ;     genCall
   0054 12s00r0F            221 	lcall	_I2C_delay
                            222 ;i2c.c:39: SCL_LOW
                            223 ;     genAssign
                            224 ;     genAnd
                            225 ;	Peephole 248.b	optimized and to xdata
   0057 90s00r00            226 	mov	dptr,#_prev_P0
   005A E0                  227 	movx	a,@dptr
   005B FA                  228 	mov	r2,a
   005C 54 FD               229 	anl	a,#0xFD
   005E F0                  230 	movx	@dptr,a
                            231 ;     genAssign
   005F 90s00r00            232 	mov	dptr,#_prev_P0
   0062 E0                  233 	movx	a,@dptr
   0063 F5 80               234 	mov	_P0,a
                            235 ;     genCall
                            236 ;	Peephole 253.b	replaced lcall/ret with ljmp
   0065 02s00r0F            237 	ljmp	_I2C_delay
                            238 ;------------------------------------------------------------
                            239 ;Allocation info for local variables in function 'I2C_stop'
                            240 ;------------------------------------------------------------
                            241 ;------------------------------------------------------------
                            242 ;i2c.c:42: void I2C_stop (void)			// Assumes SCL and SDA are low at entry
                            243 ;	-----------------------------------------
                            244 ;	 function I2C_stop
                            245 ;	-----------------------------------------
   0068                     246 _I2C_stop:
                            247 ;i2c.c:44: SCL_LOW
                            248 ;     genAssign
                            249 ;     genAnd
                            250 ;	Peephole 248.b	optimized and to xdata
   0068 90s00r00            251 	mov	dptr,#_prev_P0
   006B E0                  252 	movx	a,@dptr
   006C FA                  253 	mov	r2,a
   006D 54 FD               254 	anl	a,#0xFD
   006F F0                  255 	movx	@dptr,a
                            256 ;     genAssign
   0070 90s00r00            257 	mov	dptr,#_prev_P0
   0073 E0                  258 	movx	a,@dptr
   0074 F5 80               259 	mov	_P0,a
                            260 ;     genCall
   0076 12s00r0F            261 	lcall	_I2C_delay
                            262 ;i2c.c:45: SDA_LOW
                            263 ;     genAssign
                            264 ;     genAnd
                            265 ;	Peephole 248.b	optimized and to xdata
   0079 90s00r00            266 	mov	dptr,#_prev_P0
   007C E0                  267 	movx	a,@dptr
   007D FA                  268 	mov	r2,a
   007E 54 FE               269 	anl	a,#0xFE
   0080 F0                  270 	movx	@dptr,a
                            271 ;     genAssign
   0081 90s00r00            272 	mov	dptr,#_prev_P0
   0084 E0                  273 	movx	a,@dptr
   0085 F5 80               274 	mov	_P0,a
                            275 ;     genCall
   0087 12s00r0F            276 	lcall	_I2C_delay
                            277 ;i2c.c:46: SCL_HIGH
                            278 ;     genAssign
                            279 ;     genOr
                            280 ;	Peephole 248.a	optimized or to xdata
   008A 90s00r00            281 	mov	dptr,#_prev_P0
   008D E0                  282 	movx	a,@dptr
   008E FA                  283 	mov	r2,a
   008F 44 02               284 	orl	a,#0x02
   0091 F0                  285 	movx	@dptr,a
                            286 ;     genAssign
   0092 90s00r00            287 	mov	dptr,#_prev_P0
   0095 E0                  288 	movx	a,@dptr
   0096 F5 80               289 	mov	_P0,a
   0098                     290 00101$:
                            291 ;     genAnd
   0098 74 80               292 	mov	a,#0x80
   009A 55 80               293 	anl	a,_P0
                            294 ;     genCmpEq
                            295 ;	Peephole 112.b	changed ljmp to sjmp
                            296 ;	Peephole 115.b	jump optimization
   009C FA                  297 	mov	r2,a
   009D 60 F9               298 	jz	00101$
   009F                     299 00108$:
                            300 ;     genCall
   009F 12s00r0F            301 	lcall	_I2C_delay
                            302 ;i2c.c:47: SDA_HIGH
                            303 ;     genAssign
                            304 ;     genOr
                            305 ;	Peephole 248.a	optimized or to xdata
   00A2 90s00r00            306 	mov	dptr,#_prev_P0
   00A5 E0                  307 	movx	a,@dptr
   00A6 FA                  308 	mov	r2,a
   00A7 44 01               309 	orl	a,#0x01
   00A9 F0                  310 	movx	@dptr,a
                            311 ;     genAssign
   00AA 90s00r00            312 	mov	dptr,#_prev_P0
   00AD E0                  313 	movx	a,@dptr
   00AE F5 80               314 	mov	_P0,a
                            315 ;     genCall
                            316 ;	Peephole 253.b	replaced lcall/ret with ljmp
   00B0 02s00r0F            317 	ljmp	_I2C_delay
                            318 ;------------------------------------------------------------
                            319 ;Allocation info for local variables in function 'I2C_send'
                            320 ;------------------------------------------------------------
                            321 ;dat                       Allocated with name '_I2C_send_dat_1_1'
                            322 ;x                         Allocated with name '_I2C_send_x_1_1'
                            323 ;ack                       Allocated with name '_I2C_send_ack_1_1'
                            324 ;------------------------------------------------------------
                            325 ;i2c.c:50: unsigned char I2C_send ( unsigned char dat)
                            326 ;	-----------------------------------------
                            327 ;	 function I2C_send
                            328 ;	-----------------------------------------
   00B3                     329 _I2C_send:
                            330 ;     genReceive
   00B3 E5 82               331 	mov	a,dpl
   00B5 90s00r01            332 	mov	dptr,#_I2C_send_dat_1_1
   00B8 F0                  333 	movx	@dptr,a
                            334 ;i2c.c:53: for (x=0;x<8;x++)
                            335 ;     genAssign
   00B9 7A 00               336 	mov	r2,#0x00
   00BB                     337 00113$:
                            338 ;     genCmpLt
                            339 ;     genCmp
   00BB BA 08 00            340 	cjne	r2,#0x08,00127$
   00BE                     341 00127$:
                            342 ;     genIfxJump
   00BE 40 03               343 	jc	00128$
   00C0 02s01r37            344 	ljmp	00116$
   00C3                     345 00128$:
                            346 ;i2c.c:55: if (dat & 0x80) SDA_HIGH else SDA_LOW
                            347 ;     genAssign
   00C3 90s00r01            348 	mov	dptr,#_I2C_send_dat_1_1
   00C6 E0                  349 	movx	a,@dptr
                            350 ;     genAnd
                            351 ;	Peephole 105	removed redundant mov
   00C7 FB                  352 	mov	r3,a
                            353 ;     genIfxJump
                            354 ;	Peephole 111	removed ljmp by inverse jump logic
   00C8 30 E7 17            355 	jnb	acc.7,00102$
   00CB                     356 00129$:
                            357 ;     genAssign
                            358 ;     genOr
                            359 ;	Peephole 248.a	optimized or to xdata
   00CB 90s00r00            360 	mov	dptr,#_prev_P0
   00CE E0                  361 	movx	a,@dptr
   00CF FB                  362 	mov	r3,a
   00D0 44 01               363 	orl	a,#0x01
   00D2 F0                  364 	movx	@dptr,a
                            365 ;     genAssign
   00D3 90s00r00            366 	mov	dptr,#_prev_P0
   00D6 E0                  367 	movx	a,@dptr
   00D7 F5 80               368 	mov	_P0,a
                            369 ;     genCall
   00D9 C0 02               370 	push	ar2
   00DB 12s00r0F            371 	lcall	_I2C_delay
   00DE D0 02               372 	pop	ar2
                            373 ;	Peephole 112.b	changed ljmp to sjmp
   00E0 80 15               374 	sjmp	00103$
   00E2                     375 00102$:
                            376 ;     genAssign
                            377 ;     genAnd
                            378 ;	Peephole 248.b	optimized and to xdata
   00E2 90s00r00            379 	mov	dptr,#_prev_P0
   00E5 E0                  380 	movx	a,@dptr
   00E6 FB                  381 	mov	r3,a
   00E7 54 FE               382 	anl	a,#0xFE
   00E9 F0                  383 	movx	@dptr,a
                            384 ;     genAssign
   00EA 90s00r00            385 	mov	dptr,#_prev_P0
   00ED E0                  386 	movx	a,@dptr
   00EE F5 80               387 	mov	_P0,a
                            388 ;     genCall
   00F0 C0 02               389 	push	ar2
   00F2 12s00r0F            390 	lcall	_I2C_delay
   00F5 D0 02               391 	pop	ar2
   00F7                     392 00103$:
                            393 ;i2c.c:56: SCL_HIGH
                            394 ;     genAssign
                            395 ;     genOr
                            396 ;	Peephole 248.a	optimized or to xdata
   00F7 90s00r00            397 	mov	dptr,#_prev_P0
   00FA E0                  398 	movx	a,@dptr
   00FB FB                  399 	mov	r3,a
   00FC 44 02               400 	orl	a,#0x02
   00FE F0                  401 	movx	@dptr,a
                            402 ;     genAssign
   00FF 90s00r00            403 	mov	dptr,#_prev_P0
   0102 E0                  404 	movx	a,@dptr
   0103 F5 80               405 	mov	_P0,a
   0105                     406 00104$:
                            407 ;     genAnd
   0105 74 80               408 	mov	a,#0x80
   0107 55 80               409 	anl	a,_P0
                            410 ;     genCmpEq
                            411 ;	Peephole 112.b	changed ljmp to sjmp
                            412 ;	Peephole 115.b	jump optimization
   0109 FB                  413 	mov	r3,a
   010A 60 F9               414 	jz	00104$
   010C                     415 00130$:
                            416 ;     genCall
   010C C0 02               417 	push	ar2
   010E 12s00r0F            418 	lcall	_I2C_delay
   0111 D0 02               419 	pop	ar2
                            420 ;i2c.c:57: SCL_LOW
                            421 ;     genAssign
                            422 ;     genAnd
                            423 ;	Peephole 248.b	optimized and to xdata
   0113 90s00r00            424 	mov	dptr,#_prev_P0
   0116 E0                  425 	movx	a,@dptr
   0117 FB                  426 	mov	r3,a
   0118 54 FD               427 	anl	a,#0xFD
   011A F0                  428 	movx	@dptr,a
                            429 ;     genAssign
   011B 90s00r00            430 	mov	dptr,#_prev_P0
   011E E0                  431 	movx	a,@dptr
   011F F5 80               432 	mov	_P0,a
                            433 ;     genCall
   0121 C0 02               434 	push	ar2
   0123 12s00r0F            435 	lcall	_I2C_delay
   0126 D0 02               436 	pop	ar2
                            437 ;i2c.c:58: dat = dat <<1;
                            438 ;     genAssign
   0128 90s00r01            439 	mov	dptr,#_I2C_send_dat_1_1
   012B E0                  440 	movx	a,@dptr
                            441 ;     genLeftShift
                            442 ;     genLeftShiftLiteral
                            443 ;     genlshOne
                            444 ;	Peephole 105	removed redundant mov
                            445 ;     genAssign
                            446 ;	Peephole 100	removed redundant mov
                            447 ;	Peephole 204	removed redundant mov
   012C 25 E0               448 	add	a,acc
   012E FB                  449 	mov	r3,a
   012F 90s00r01            450 	mov	dptr,#_I2C_send_dat_1_1
   0132 F0                  451 	movx	@dptr,a
                            452 ;i2c.c:53: for (x=0;x<8;x++)
                            453 ;     genPlus
                            454 ;     genPlusIncr
   0133 0A                  455 	inc	r2
   0134 02s00rBB            456 	ljmp	00113$
   0137                     457 00116$:
                            458 ;i2c.c:60: SDA_HIGH
                            459 ;     genAssign
                            460 ;     genOr
                            461 ;	Peephole 248.a	optimized or to xdata
   0137 90s00r00            462 	mov	dptr,#_prev_P0
   013A E0                  463 	movx	a,@dptr
   013B FA                  464 	mov	r2,a
   013C 44 01               465 	orl	a,#0x01
   013E F0                  466 	movx	@dptr,a
                            467 ;     genAssign
   013F 90s00r00            468 	mov	dptr,#_prev_P0
   0142 E0                  469 	movx	a,@dptr
   0143 F5 80               470 	mov	_P0,a
                            471 ;     genCall
   0145 12s00r0F            472 	lcall	_I2C_delay
                            473 ;i2c.c:61: SCL_HIGH
                            474 ;     genAssign
                            475 ;     genOr
                            476 ;	Peephole 248.a	optimized or to xdata
   0148 90s00r00            477 	mov	dptr,#_prev_P0
   014B E0                  478 	movx	a,@dptr
   014C FA                  479 	mov	r2,a
   014D 44 02               480 	orl	a,#0x02
   014F F0                  481 	movx	@dptr,a
                            482 ;     genAssign
   0150 90s00r00            483 	mov	dptr,#_prev_P0
   0153 E0                  484 	movx	a,@dptr
   0154 F5 80               485 	mov	_P0,a
   0156                     486 00107$:
                            487 ;     genAnd
   0156 74 80               488 	mov	a,#0x80
   0158 55 80               489 	anl	a,_P0
                            490 ;     genCmpEq
                            491 ;	Peephole 112.b	changed ljmp to sjmp
                            492 ;	Peephole 115.b	jump optimization
   015A FA                  493 	mov	r2,a
   015B 60 F9               494 	jz	00107$
   015D                     495 00131$:
                            496 ;     genCall
   015D 12s00r0F            497 	lcall	_I2C_delay
                            498 ;i2c.c:62: ack = P0;			// read the input SDA
                            499 ;     genAssign
   0160 90s00r02            500 	mov	dptr,#_I2C_send_ack_1_1
   0163 E5 80               501 	mov	a,_P0
   0165 F0                  502 	movx	@dptr,a
                            503 ;i2c.c:63: SCL_LOW
                            504 ;     genAssign
                            505 ;     genAnd
                            506 ;	Peephole 248.b	optimized and to xdata
   0166 90s00r00            507 	mov	dptr,#_prev_P0
   0169 E0                  508 	movx	a,@dptr
   016A FA                  509 	mov	r2,a
   016B 54 FD               510 	anl	a,#0xFD
   016D F0                  511 	movx	@dptr,a
                            512 ;     genAssign
   016E 90s00r00            513 	mov	dptr,#_prev_P0
   0171 E0                  514 	movx	a,@dptr
   0172 F5 80               515 	mov	_P0,a
                            516 ;     genCall
   0174 12s00r0F            517 	lcall	_I2C_delay
                            518 ;i2c.c:64: SDA_LOW
                            519 ;     genAssign
                            520 ;     genAnd
                            521 ;	Peephole 248.b	optimized and to xdata
   0177 90s00r00            522 	mov	dptr,#_prev_P0
   017A E0                  523 	movx	a,@dptr
   017B FA                  524 	mov	r2,a
   017C 54 FE               525 	anl	a,#0xFE
   017E F0                  526 	movx	@dptr,a
                            527 ;     genAssign
   017F 90s00r00            528 	mov	dptr,#_prev_P0
   0182 E0                  529 	movx	a,@dptr
   0183 F5 80               530 	mov	_P0,a
                            531 ;     genCall
   0185 12s00r0F            532 	lcall	_I2C_delay
                            533 ;i2c.c:65: if ((ack&0x40)==0) return 1; else return 0;  
                            534 ;     genAssign
   0188 90s00r02            535 	mov	dptr,#_I2C_send_ack_1_1
   018B E0                  536 	movx	a,@dptr
   018C FA                  537 	mov	r2,a
                            538 ;     genAnd
   018D 53 02 40            539 	anl	ar2,#0x40
                            540 ;     genCmpEq
                            541 ;	Peephole 112.b	changed ljmp to sjmp
                            542 ;	Peephole 199	optimized misc jump sequence
   0190 BA 00 04            543 	cjne	r2,#0x00,00111$
                            544 ;00132$:
                            545 ;	Peephole 200	removed redundant sjmp
   0193                     546 00133$:
                            547 ;     genRet
   0193 75 82 01            548 	mov	dpl,#0x01
                            549 ;	Peephole 112.b	changed ljmp to sjmp
                            550 ;     genRet
                            551 ;	Peephole 237.a	removed sjmp to ret
   0196 22                  552 	ret
   0197                     553 00111$:
   0197 75 82 00            554 	mov	dpl,#0x00
   019A                     555 00117$:
   019A 22                  556 	ret
                            557 ;------------------------------------------------------------
                            558 ;Allocation info for local variables in function 'I2C_get'
                            559 ;------------------------------------------------------------
                            560 ;ack                       Allocated with name '_I2C_get_ack_1_1'
                            561 ;dat                       Allocated with name '_I2C_get_dat_1_1'
                            562 ;x                         Allocated with name '_I2C_get_x_1_1'
                            563 ;------------------------------------------------------------
                            564 ;i2c.c:68: unsigned char I2C_get (unsigned char ack)
                            565 ;	-----------------------------------------
                            566 ;	 function I2C_get
                            567 ;	-----------------------------------------
   019B                     568 _I2C_get:
                            569 ;     genReceive
   019B E5 82               570 	mov	a,dpl
   019D 90s00r03            571 	mov	dptr,#_I2C_get_ack_1_1
   01A0 F0                  572 	movx	@dptr,a
                            573 ;i2c.c:71: SDA_HIGH							// SDA goes high (undriven)
                            574 ;     genAssign
                            575 ;     genOr
                            576 ;	Peephole 248.a	optimized or to xdata
   01A1 90s00r00            577 	mov	dptr,#_prev_P0
   01A4 E0                  578 	movx	a,@dptr
   01A5 FA                  579 	mov	r2,a
   01A6 44 01               580 	orl	a,#0x01
   01A8 F0                  581 	movx	@dptr,a
                            582 ;     genAssign
   01A9 90s00r00            583 	mov	dptr,#_prev_P0
   01AC E0                  584 	movx	a,@dptr
   01AD F5 80               585 	mov	_P0,a
                            586 ;     genCall
   01AF 12s00r0F            587 	lcall	_I2C_delay
                            588 ;i2c.c:72: for (x=0;x<8;x++)
                            589 ;     genAssign
   01B2 7A 00               590 	mov	r2,#0x00
   01B4                     591 00113$:
                            592 ;     genCmpLt
                            593 ;     genCmp
   01B4 BA 08 00            594 	cjne	r2,#0x08,00127$
   01B7                     595 00127$:
                            596 ;     genIfxJump
                            597 ;	Peephole 108	removed ljmp by inverse jump logic
   01B7 50 57               598 	jnc	00116$
   01B9                     599 00128$:
                            600 ;i2c.c:74: SCL_HIGH
                            601 ;     genAssign
                            602 ;     genOr
                            603 ;	Peephole 248.a	optimized or to xdata
   01B9 90s00r00            604 	mov	dptr,#_prev_P0
   01BC E0                  605 	movx	a,@dptr
   01BD FB                  606 	mov	r3,a
   01BE 44 02               607 	orl	a,#0x02
   01C0 F0                  608 	movx	@dptr,a
                            609 ;     genAssign
   01C1 90s00r00            610 	mov	dptr,#_prev_P0
   01C4 E0                  611 	movx	a,@dptr
   01C5 F5 80               612 	mov	_P0,a
   01C7                     613 00101$:
                            614 ;     genAnd
   01C7 74 80               615 	mov	a,#0x80
   01C9 55 80               616 	anl	a,_P0
                            617 ;     genCmpEq
                            618 ;	Peephole 112.b	changed ljmp to sjmp
                            619 ;	Peephole 115.b	jump optimization
   01CB FB                  620 	mov	r3,a
   01CC 60 F9               621 	jz	00101$
   01CE                     622 00129$:
                            623 ;     genCall
   01CE C0 02               624 	push	ar2
   01D0 12s00r0F            625 	lcall	_I2C_delay
   01D3 D0 02               626 	pop	ar2
                            627 ;i2c.c:75: if ((P0 & 0x40)==0x40) dat=(dat<<1)+1; else dat=dat<<1;
                            628 ;     genAnd
   01D5 74 40               629 	mov	a,#0x40
   01D7 55 80               630 	anl	a,_P0
   01D9 FB                  631 	mov	r3,a
                            632 ;     genCmpEq
                            633 ;	Peephole 112.b	changed ljmp to sjmp
                            634 ;	Peephole 199	optimized misc jump sequence
   01DA BB 40 10            635 	cjne	r3,#0x40,00105$
                            636 ;00130$:
                            637 ;	Peephole 200	removed redundant sjmp
   01DD                     638 00131$:
                            639 ;     genAssign
   01DD 90s00r04            640 	mov	dptr,#_I2C_get_dat_1_1
   01E0 E0                  641 	movx	a,@dptr
                            642 ;     genLeftShift
                            643 ;     genLeftShiftLiteral
                            644 ;     genlshOne
                            645 ;	Peephole 105	removed redundant mov
                            646 ;	Peephole 204	removed redundant mov
   01E1 25 E0               647 	add	a,acc
   01E3 FB                  648 	mov	r3,a
                            649 ;     genPlus
   01E4 90s00r04            650 	mov	dptr,#_I2C_get_dat_1_1
                            651 ;     genPlusIncr
   01E7 74 01               652 	mov	a,#0x01
                            653 ;	Peephole 236.a	used r3 instead of ar3
   01E9 2B                  654 	add	a,r3
   01EA F0                  655 	movx	@dptr,a
                            656 ;	Peephole 112.b	changed ljmp to sjmp
   01EB 80 0B               657 	sjmp	00106$
   01ED                     658 00105$:
                            659 ;     genAssign
   01ED 90s00r04            660 	mov	dptr,#_I2C_get_dat_1_1
   01F0 E0                  661 	movx	a,@dptr
                            662 ;     genLeftShift
                            663 ;     genLeftShiftLiteral
                            664 ;     genlshOne
                            665 ;	Peephole 105	removed redundant mov
                            666 ;     genAssign
                            667 ;	Peephole 100	removed redundant mov
                            668 ;	Peephole 204	removed redundant mov
   01F1 25 E0               669 	add	a,acc
   01F3 FB                  670 	mov	r3,a
   01F4 90s00r04            671 	mov	dptr,#_I2C_get_dat_1_1
   01F7 F0                  672 	movx	@dptr,a
   01F8                     673 00106$:
                            674 ;i2c.c:76: SCL_LOW
                            675 ;     genAssign
                            676 ;     genAnd
                            677 ;	Peephole 248.b	optimized and to xdata
   01F8 90s00r00            678 	mov	dptr,#_prev_P0
   01FB E0                  679 	movx	a,@dptr
   01FC FB                  680 	mov	r3,a
   01FD 54 FD               681 	anl	a,#0xFD
   01FF F0                  682 	movx	@dptr,a
                            683 ;     genAssign
   0200 90s00r00            684 	mov	dptr,#_prev_P0
   0203 E0                  685 	movx	a,@dptr
   0204 F5 80               686 	mov	_P0,a
                            687 ;     genCall
   0206 C0 02               688 	push	ar2
   0208 12s00r0F            689 	lcall	_I2C_delay
   020B D0 02               690 	pop	ar2
                            691 ;i2c.c:72: for (x=0;x<8;x++)
                            692 ;     genPlus
                            693 ;     genPlusIncr
   020D 0A                  694 	inc	r2
                            695 ;	Peephole 112.b	changed ljmp to sjmp
   020E 80 A4               696 	sjmp	00113$
   0210                     697 00116$:
                            698 ;i2c.c:78: if (ack) 
                            699 ;     genAssign
   0210 90s00r03            700 	mov	dptr,#_I2C_get_ack_1_1
   0213 E0                  701 	movx	a,@dptr
                            702 ;     genIfx
                            703 ;	Peephole 105	removed redundant mov
   0214 FA                  704 	mov	r2,a
                            705 ;     genIfxJump
                            706 ;	Peephole 110	removed ljmp by inverse jump logic
   0215 60 13               707 	jz	00108$
   0217                     708 00132$:
                            709 ;i2c.c:79: SDA_LOW							// if wanted, we will ACK the transmission
                            710 ;     genAssign
                            711 ;     genAnd
                            712 ;	Peephole 248.b	optimized and to xdata
   0217 90s00r00            713 	mov	dptr,#_prev_P0
   021A E0                  714 	movx	a,@dptr
   021B FA                  715 	mov	r2,a
   021C 54 FE               716 	anl	a,#0xFE
   021E F0                  717 	movx	@dptr,a
                            718 ;     genAssign
   021F 90s00r00            719 	mov	dptr,#_prev_P0
   0222 E0                  720 	movx	a,@dptr
   0223 F5 80               721 	mov	_P0,a
                            722 ;     genCall
   0225 12s00r0F            723 	lcall	_I2C_delay
                            724 ;	Peephole 112.b	changed ljmp to sjmp
   0228 80 11               725 	sjmp	00109$
   022A                     726 00108$:
                            727 ;i2c.c:81: SDA_HIGH						// else we just don't!!!
                            728 ;     genAssign
                            729 ;     genOr
                            730 ;	Peephole 248.a	optimized or to xdata
   022A 90s00r00            731 	mov	dptr,#_prev_P0
   022D E0                  732 	movx	a,@dptr
   022E FA                  733 	mov	r2,a
   022F 44 01               734 	orl	a,#0x01
   0231 F0                  735 	movx	@dptr,a
                            736 ;     genAssign
   0232 90s00r00            737 	mov	dptr,#_prev_P0
   0235 E0                  738 	movx	a,@dptr
   0236 F5 80               739 	mov	_P0,a
                            740 ;     genCall
   0238 12s00r0F            741 	lcall	_I2C_delay
   023B                     742 00109$:
                            743 ;i2c.c:82: SCL_HIGH							// create a last clock-pulse
                            744 ;     genAssign
                            745 ;     genOr
                            746 ;	Peephole 248.a	optimized or to xdata
   023B 90s00r00            747 	mov	dptr,#_prev_P0
   023E E0                  748 	movx	a,@dptr
   023F FA                  749 	mov	r2,a
   0240 44 02               750 	orl	a,#0x02
   0242 F0                  751 	movx	@dptr,a
                            752 ;     genAssign
   0243 90s00r00            753 	mov	dptr,#_prev_P0
   0246 E0                  754 	movx	a,@dptr
   0247 F5 80               755 	mov	_P0,a
   0249                     756 00110$:
                            757 ;     genAnd
   0249 74 80               758 	mov	a,#0x80
   024B 55 80               759 	anl	a,_P0
                            760 ;     genCmpEq
                            761 ;	Peephole 112.b	changed ljmp to sjmp
                            762 ;	Peephole 115.b	jump optimization
   024D FA                  763 	mov	r2,a
   024E 60 F9               764 	jz	00110$
   0250                     765 00133$:
                            766 ;     genCall
   0250 12s00r0F            767 	lcall	_I2C_delay
                            768 ;i2c.c:83: SCL_LOW
                            769 ;     genAssign
                            770 ;     genAnd
                            771 ;	Peephole 248.b	optimized and to xdata
   0253 90s00r00            772 	mov	dptr,#_prev_P0
   0256 E0                  773 	movx	a,@dptr
   0257 FA                  774 	mov	r2,a
   0258 54 FD               775 	anl	a,#0xFD
   025A F0                  776 	movx	@dptr,a
                            777 ;     genAssign
   025B 90s00r00            778 	mov	dptr,#_prev_P0
   025E E0                  779 	movx	a,@dptr
   025F F5 80               780 	mov	_P0,a
                            781 ;     genCall
   0261 12s00r0F            782 	lcall	_I2C_delay
                            783 ;i2c.c:84: SDA_LOW							// exit the function with both signals in a low state
                            784 ;     genAssign
                            785 ;     genAnd
                            786 ;	Peephole 248.b	optimized and to xdata
   0264 90s00r00            787 	mov	dptr,#_prev_P0
   0267 E0                  788 	movx	a,@dptr
   0268 FA                  789 	mov	r2,a
   0269 54 FE               790 	anl	a,#0xFE
   026B F0                  791 	movx	@dptr,a
                            792 ;     genAssign
   026C 90s00r00            793 	mov	dptr,#_prev_P0
   026F E0                  794 	movx	a,@dptr
   0270 F5 80               795 	mov	_P0,a
                            796 ;     genCall
   0272 12s00r0F            797 	lcall	_I2C_delay
                            798 ;i2c.c:85: return (dat);    
                            799 ;     genAssign
   0275 90s00r04            800 	mov	dptr,#_I2C_get_dat_1_1
   0278 E0                  801 	movx	a,@dptr
                            802 ;     genRet
                            803 ;	Peephole 234	loading dpl directly from a(ccumulator), r2 not set
   0279 F5 82               804 	mov	dpl,a
   027B                     805 00117$:
   027B 22                  806 	ret
                            807 	.area CSEG    (CODE)
                            808 	.area XINIT   (CODE)
